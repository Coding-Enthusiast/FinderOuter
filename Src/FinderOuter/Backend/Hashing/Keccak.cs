// The FinderOuter
// Copyright (c) 2020 Coding Enthusiast
// Distributed under the MIT software license, see the accompanying
// file LICENCE or http://www.opensource.org/licenses/mit-license.php.

using System;
using System.Runtime.CompilerServices;

namespace FinderOuter.Backend.Cryptography.Hashing
{
    public abstract class Keccak
    {
        /// <summary>
        /// Size of the blocks used in each round
        /// </summary>
        public abstract int BlockByteSize { get; }
        protected abstract void SetSecondPadBit();
        protected abstract unsafe void Absorb(byte* dPt);
        protected abstract byte[] GetBytes();
        protected virtual void DoSecondHash()
        {
            throw new NotImplementedException();
        }


        protected byte[] finalBlock;
        protected int rateInBytes, outLen;
        protected byte suffix;
        protected ulong h0, h1, h2, h3, h4, h5, h6, h7, h8, h9, h10,
                        h11, h12, h13, h14, h15, h16, h17, h18, h19, h20,
                        h21, h22, h23, h24;



        protected void Init()
        {
            h0 = h1 = h2 = h3 = h4 = h5 = h6 = h7 = h8 = h9 = h10 = h11 = h12
               = h13 = h14 = h15 = h16 = h17 = h18 = h19 = h20 = h21 = h22 = h23 = h24 = 0;
        }

        /// <summary>
        /// Computes the hash value for the specified byte array.
        /// </summary>
        /// <exception cref="ArgumentNullException"/>
        /// <exception cref="ObjectDisposedException"/>
        /// <param name="data">The byte array to compute hash for</param>
        /// <returns>The computed hash</returns>
        public virtual unsafe byte[] ComputeHash(byte[] data)
        {
            if (disposedValue)
                throw new ObjectDisposedException(nameof(Keccak));
            if (data == null)
                throw new ArgumentNullException(nameof(data), "Data can not be null.");


            Init();
            finalBlock = new byte[BlockByteSize];

            fixed (byte* dataPointer = data, fPt = &finalBlock[0])
            {
                int remainingBytes = data.Length;

                byte* dPt = dataPointer;
                while (remainingBytes >= BlockByteSize)
                {
                    Absorb(dPt);

                    KeccakF1600();

                    remainingBytes -= BlockByteSize;
                    dPt += BlockByteSize;
                }

                if (remainingBytes != 0)
                {
                    // This copy makes this extra step fixed time
                    Buffer.BlockCopy(data, data.Length - remainingBytes, finalBlock, 0, remainingBytes);
                    fPt[remainingBytes] ^= suffix;

                    Absorb(fPt);
                }
                else
                {
                    h0 ^= suffix;
                }

                SetSecondPadBit();

                // Switch to the squeezing phase
                KeccakF1600();
            }

            return GetBytes();
        }


        protected void KeccakF1600()
        {
            /**** Round #1/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            ulong C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            ulong C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            ulong C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            ulong C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            ulong C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            ulong D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            ulong temp;
            ulong current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            ulong temp0, temp1, temp2, temp3, temp4;
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 1;


            /**** Round #2/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 2;
            h0 ^= 128;
            h0 ^= 32768;


            /**** Round #3/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 2;
            h0 ^= 8;
            h0 ^= 128;
            h0 ^= 32768;
            h0 ^= 9223372036854775808;


            /**** Round #4/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 32768;
            h0 ^= 2147483648;
            h0 ^= 9223372036854775808;


            /**** Round #5/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 1;
            h0 ^= 2;
            h0 ^= 8;
            h0 ^= 128;
            h0 ^= 32768;


            /**** Round #6/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 1;
            h0 ^= 2147483648;


            /**** Round #7/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 1;
            h0 ^= 128;
            h0 ^= 32768;
            h0 ^= 2147483648;
            h0 ^= 9223372036854775808;


            /**** Round #8/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 1;
            h0 ^= 8;
            h0 ^= 32768;
            h0 ^= 9223372036854775808;


            /**** Round #9/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 2;
            h0 ^= 8;
            h0 ^= 128;


            /**** Round #10/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 8;
            h0 ^= 128;


            /**** Round #11/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 1;
            h0 ^= 8;
            h0 ^= 32768;
            h0 ^= 2147483648;


            /**** Round #12/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 2;
            h0 ^= 8;
            h0 ^= 2147483648;


            /**** Round #13/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 1;
            h0 ^= 2;
            h0 ^= 8;
            h0 ^= 128;
            h0 ^= 32768;
            h0 ^= 2147483648;


            /**** Round #14/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 1;
            h0 ^= 2;
            h0 ^= 8;
            h0 ^= 128;
            h0 ^= 9223372036854775808;


            /**** Round #15/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 1;
            h0 ^= 8;
            h0 ^= 128;
            h0 ^= 32768;
            h0 ^= 9223372036854775808;


            /**** Round #16/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 1;
            h0 ^= 2;
            h0 ^= 32768;
            h0 ^= 9223372036854775808;


            /**** Round #17/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 2;
            h0 ^= 32768;
            h0 ^= 9223372036854775808;


            /**** Round #18/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 128;
            h0 ^= 9223372036854775808;


            /**** Round #19/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 2;
            h0 ^= 8;
            h0 ^= 32768;


            /**** Round #20/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 2;
            h0 ^= 8;
            h0 ^= 2147483648;
            h0 ^= 9223372036854775808;


            /**** Round #21/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 1;
            h0 ^= 128;
            h0 ^= 32768;
            h0 ^= 2147483648;
            h0 ^= 9223372036854775808;


            /**** Round #22/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 128;
            h0 ^= 32768;
            h0 ^= 9223372036854775808;


            /**** Round #23/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 1;
            h0 ^= 2147483648;


            /**** Round #24/24 ****/
            /* === θ step (see [Keccak Reference, Section 2.3.2]) === */
            C0 = h0 ^ h5 ^ h10 ^ h15 ^ h20;
            C1 = h1 ^ h6 ^ h11 ^ h16 ^ h21;
            C2 = h2 ^ h7 ^ h12 ^ h17 ^ h22;
            C3 = h3 ^ h8 ^ h13 ^ h18 ^ h23;
            C4 = h4 ^ h9 ^ h14 ^ h19 ^ h24;
            D = C4 ^ ROL64(C1, 1);
            h0 ^= D;
            h5 ^= D;
            h10 ^= D;
            h15 ^= D;
            h20 ^= D;
            D = C0 ^ ROL64(C2, 1);
            h1 ^= D;
            h6 ^= D;
            h11 ^= D;
            h16 ^= D;
            h21 ^= D;
            D = C1 ^ ROL64(C3, 1);
            h2 ^= D;
            h7 ^= D;
            h12 ^= D;
            h17 ^= D;
            h22 ^= D;
            D = C2 ^ ROL64(C4, 1);
            h3 ^= D;
            h8 ^= D;
            h13 ^= D;
            h18 ^= D;
            h23 ^= D;
            D = C3 ^ ROL64(C0, 1);
            h4 ^= D;
            h9 ^= D;
            h14 ^= D;
            h19 ^= D;
            h24 ^= D;

            /* === ρ and π steps (see [Keccak Reference, Sections 2.3.3 and 2.3.4]) === */
            current = h1;
            temp = h10;
            h10 = ROL64(current, 1);
            current = temp;
            temp = h7;
            h7 = ROL64(current, 3);
            current = temp;
            temp = h11;
            h11 = ROL64(current, 6);
            current = temp;
            temp = h17;
            h17 = ROL64(current, 10);
            current = temp;
            temp = h18;
            h18 = ROL64(current, 15);
            current = temp;
            temp = h3;
            h3 = ROL64(current, 21);
            current = temp;
            temp = h5;
            h5 = ROL64(current, 28);
            current = temp;
            temp = h16;
            h16 = ROL64(current, 36);
            current = temp;
            temp = h8;
            h8 = ROL64(current, 45);
            current = temp;
            temp = h21;
            h21 = ROL64(current, 55);
            current = temp;
            temp = h24;
            h24 = ROL64(current, 2);
            current = temp;
            temp = h4;
            h4 = ROL64(current, 14);
            current = temp;
            temp = h15;
            h15 = ROL64(current, 27);
            current = temp;
            temp = h23;
            h23 = ROL64(current, 41);
            current = temp;
            temp = h19;
            h19 = ROL64(current, 56);
            current = temp;
            temp = h13;
            h13 = ROL64(current, 8);
            current = temp;
            temp = h12;
            h12 = ROL64(current, 25);
            current = temp;
            temp = h2;
            h2 = ROL64(current, 43);
            current = temp;
            temp = h20;
            h20 = ROL64(current, 62);
            current = temp;
            temp = h14;
            h14 = ROL64(current, 18);
            current = temp;
            temp = h22;
            h22 = ROL64(current, 39);
            current = temp;
            temp = h9;
            h9 = ROL64(current, 61);
            current = temp;
            temp = h6;
            h6 = ROL64(current, 20);
            current = temp;
            temp = h1;
            h1 = ROL64(current, 44);
            current = temp;

            /* === χ step (see [Keccak Reference, Section 2.3.1]) === */
            temp0 = h0;
            temp1 = h1;
            temp2 = h2;
            temp3 = h3;
            temp4 = h4;
            h0 = temp0 ^ ((~temp1) & temp2);
            h1 = temp1 ^ ((~temp2) & temp3);
            h2 = temp2 ^ ((~temp3) & temp4);
            h3 = temp3 ^ ((~temp4) & temp0);
            h4 = temp4 ^ ((~temp0) & temp1);
            temp0 = h5;
            temp1 = h6;
            temp2 = h7;
            temp3 = h8;
            temp4 = h9;
            h5 = temp0 ^ ((~temp1) & temp2);
            h6 = temp1 ^ ((~temp2) & temp3);
            h7 = temp2 ^ ((~temp3) & temp4);
            h8 = temp3 ^ ((~temp4) & temp0);
            h9 = temp4 ^ ((~temp0) & temp1);
            temp0 = h10;
            temp1 = h11;
            temp2 = h12;
            temp3 = h13;
            temp4 = h14;
            h10 = temp0 ^ ((~temp1) & temp2);
            h11 = temp1 ^ ((~temp2) & temp3);
            h12 = temp2 ^ ((~temp3) & temp4);
            h13 = temp3 ^ ((~temp4) & temp0);
            h14 = temp4 ^ ((~temp0) & temp1);
            temp0 = h15;
            temp1 = h16;
            temp2 = h17;
            temp3 = h18;
            temp4 = h19;
            h15 = temp0 ^ ((~temp1) & temp2);
            h16 = temp1 ^ ((~temp2) & temp3);
            h17 = temp2 ^ ((~temp3) & temp4);
            h18 = temp3 ^ ((~temp4) & temp0);
            h19 = temp4 ^ ((~temp0) & temp1);
            temp0 = h20;
            temp1 = h21;
            temp2 = h22;
            temp3 = h23;
            temp4 = h24;
            h20 = temp0 ^ ((~temp1) & temp2);
            h21 = temp1 ^ ((~temp2) & temp3);
            h22 = temp2 ^ ((~temp3) & temp4);
            h23 = temp3 ^ ((~temp4) & temp0);
            h24 = temp4 ^ ((~temp0) & temp1);

            /* === ι step (see [Keccak Reference, Section 2.3.5]) === */
            h0 ^= 8;
            h0 ^= 32768;
            h0 ^= 2147483648;
            h0 ^= 9223372036854775808;
        }

        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        private ulong ROL64(ulong a, int n)
        {
            return (a << n) ^ (a >> (64 - n));
        }





        protected bool disposedValue = false; // To detect redundant calls

        protected virtual void Dispose(bool disposing)
        {
            if (!disposedValue)
            {
                if (disposing)
                {
                    if (finalBlock != null)
                        Array.Clear(finalBlock, 0, finalBlock.Length);
                    finalBlock = null;
                }

                disposedValue = true;
            }
        }

        public void Dispose()
        {
            Dispose(true);
        }
    }
}
